<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Where the fuck is my girlfriend?</title>

  <!-- Fonts: Pinyon Script (title), Inika (everything else) -->
  <link href="https://fonts.googleapis.com/css2?family=Inika:wght@400;700&family=Pinyon+Script&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg1:#eddcff;
      --bg2:#dcc6ff;
      --card-bg: rgba(255,255,255,0.16);
      --ink:#1b1330;                /* body text */
      --ring: rgba(255,255,255,0.45);
      --accent:#b388ff;
      --shadow: 0 12px 30px rgba(20,10,40,.18);
      --heart:#100a22;             /* darker than --ink */
      --heartOpacity: .26;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body{
      margin:0;

      /* âœ… Hearts fixed: proper SVG path + 6-digit hex + fill-opacity */
      background:
        url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='36' height='36' viewBox='0 0 24 24'><path d='M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 6 4.02 4 6.5 4c1.73 0 3.39 1 4.2 2.43C11.51 5 13.17 4 14.9 4 17.38 4 19.4 6 19.4 8.5c0 3.78-3.41 6.86-8.55 11.53L12 21.35z' fill='%23100a22' fill-opacity='0.26'/></svg>") repeat,
        linear-gradient(160deg,var(--bg1),var(--bg2));
      background-size: 36px 36px, auto;

      color:var(--ink);
      font-family: 'Inika', serif;
      display:grid;
      place-items:center;
      padding:24px;
    }

    .wrap{ width:min(840px,95vw); text-align:center; }

    .card{
      background:var(--card-bg);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border:2px solid var(--ring);
      border-radius:22px;
      padding:22px clamp(14px,4vw,28px);
      box-shadow: var(--shadow);
      color:var(--ink);
      text-align:center;
      position:relative;
    }
    .header-card { margin-bottom: 16px; }

    .title{
      margin:0;
      font-family:'Pinyon Script', cursive; /* title only */
      font-size: clamp(28px, 6vw, 54px);
      font-weight: 400;
      color:#000;
      line-height:1.05;
    }
    #dayLabel{
      margin:8px 0 0 0;
      font-size: clamp(16px, 3.6vw, 28px);  /* smaller for cohesion */
      font-weight: 700;
      letter-spacing:.2px;
      color:#000;
      font-family: 'Inika', serif;
    }

    .big{
      font-size: clamp(22px, 4.6vw, 34px);
      font-weight: 700;
      line-height: 1.25;
    }
    .range, .clock{
      font-size: clamp(14px, 2.6vw, 18px);
      opacity: 0.95;
      margin-top: 10px;
      font-weight: 400;
    }

    /* TZ toggle */
    .tz-toggle{
      position:absolute; top:10px; right:10px;
      background: var(--accent);
      color:#fff; border:none; cursor:pointer;
      font-weight:700; border-radius:999px;
      padding:6px 12px; box-shadow:0 8px 18px rgba(0,0,0,.15);
      letter-spacing:.2px;
      font-family: 'Inika', serif;
    }
    .tz-menu{
      position:absolute; top:48px; right:10px;
      background:#fff; color:#1f1236;
      border-radius:12px; border:2px solid var(--ring);
      box-shadow: var(--shadow);
      display:none; min-width: 190px; overflow:hidden;
      text-align:left;
      font-family: 'Inika', serif;
      z-index: 10;
    }
    .tz-item{ padding:10px 12px; cursor:pointer; font-weight:700; border-bottom:1px solid #00000010; }
    .tz-item:last-child{ border-bottom:none; }
    .tz-item:hover{ background:#f3ecff; }

    /* Preview controls (optional) */
    .preview-toggle{
      position:absolute; top:10px; left:10px;
      background:#fff; color:#1f1236; border:none; cursor:pointer;
      font-weight:700; border-radius:999px;
      padding:6px 12px; box-shadow:0 8px 18px rgba(0,0,0,.12);
      letter-spacing:.2px;
      font-family: 'Inika', serif;
      border:2px solid var(--ring);
    }
    .preview-panel{
      position:absolute; top:48px; left:10px;
      background:#fff; color:#1f1236;
      border-radius:12px; border:2px solid var(--ring);
      box-shadow: var(--shadow);
      display:none; min-width: 220px; padding:10px;
      text-align:left; z-index: 10; font-family:'Inika',serif;
    }
    .row{ display:flex; gap:8px; align-items:center; margin:6px 0; }
    select,input[type="time"]{
      border:1px solid #ddd; border-radius:8px; padding:6px 8px; font-family:'Inika',serif;
    }
    .btn{
      background:var(--accent); color:#fff; border:none; border-radius:10px; padding:6px 10px;
      font-weight:700; cursor:pointer; font-family:'Inika',serif;
    }
    .btn.secondary{ background:#eee; color:#1f1236; border:1px solid #ddd; }

    @media (prefers-reduced-motion:no-preference){
      .fade{ animation:fade .4s ease-out }
      @keyframes fade{ from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:none} }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <!-- Header card: Title + Day -->
    <div class="card header-card fade">
      <h1 class="title">Where the fuck is my girlfriend?</h1>
      <h2 id="dayLabel">Loadingâ€¦</h2>
    </div>

    <!-- Main class/status card -->
    <div class="card fade">
      <!-- Optional time-travel preview -->
      <button id="previewToggle" class="preview-toggle" aria-haspopup="true" aria-expanded="false">Preview</button>
      <div id="previewPanel" class="preview-panel" role="dialog" aria-label="Preview time">
        <div class="row">
          <label for="prevDay" style="min-width:70px">Day</label>
          <select id="prevDay">
            <option value="0">Sunday</option>
            <option value="1">Monday</option>
            <option value="2">Tuesday</option>
            <option value="3">Wednesday</option>
            <option value="4">Thursday</option>
            <option value="5">Friday</option>
            <option value="6">Saturday</option>
          </select>
        </div>
        <div class="row">
          <label for="prevTime" style="min-width:70px">Time</label>
          <input id="prevTime" type="time" step="60" value="10:00">
        </div>
        <div class="row" style="justify-content:flex-end; gap:8px; margin-top:8px">
          <button id="applyPreview" class="btn">Apply</button>
          <button id="clearPreview" class="btn secondary">Live</button>
        </div>
      </div>

      <!-- TZ toggle -->
      <button id="tzToggle" class="tz-toggle" aria-haspopup="true" aria-expanded="false">ðŸŒ´ California</button>
      <div id="tzMenu" class="tz-menu" role="menu" aria-label="Display timezone">
        <div class="tz-item" data-tz="CA" role="menuitem">ðŸŒ´ California</div>
        <div class="tz-item" data-tz="CHI" role="menuitem">ðŸ«˜ Chicago</div>
      </div>

      <div id="status" class="big">Loadingâ€¦</div>
      <div id="range" class="range">â€”</div>
      <div id="clock" class="clock">â€”</div>
    </div>
  </div>

  <script>
    /* ===== Schedule (anchored to California) ===== */
    const schedule = {
      1: [
        { name: "Chemistry",           start: "10:00", end: "10:50" },
        { name: "Intro to Psychology", start: "11:00", end: "12:15" },
        { name: "Uncanny",             start: "13:15", end: "14:30" },
      ],
      2: [ { name: "Reasoning bout Unreasonable", start: "11:00", end: "12:15" } ],
      3: [
        { name: "Chemistry",           start: "10:00", end: "10:50" },
        { name: "Intro to Psychology", start: "11:00", end: "12:15" },
        { name: "Uncanny",             start: "13:15", end: "14:30" },
      ],
      4: [
        { name: "Reasoning bout Unreasonable", start: "11:00", end: "12:15" },
        { name: "Chem Lab",                     start: "13:00", end: "16:00" },
      ],
      5: [ { name: "Chemistry", start: "10:00", end: "10:50" } ],
      0: [], 6: []
    };

    const lockedPhrase = "She's locked asf";
    const BASE_TZ = "America/Los_Angeles";

    const DISPLAY_OPTS = {
      CA: { label: "ðŸŒ´ California", tz: "America/Los_Angeles", offsetMinutesFromCA: 0 },
      CHI:{ label: "ðŸ«˜ Chicago",    tz: "America/Chicago",     offsetMinutesFromCA: 120 },
    };
    let displayKey = localStorage.getItem("displayTZ") || "CA";

    // ---------- Helpers ----------
    function toMinutes(hhmm){ const [h,m]=hhmm.split(":").map(Number); return h*60+m; }
    function pad(n){ return n.toString().padStart(2,"0"); }
    function fmt12(h24,m){ const am=h24<12; const h12=((h24+11)%12)+1; return `${h12}:${pad(m)} ${am?"AM":"PM"}`; }

    function nowInTZ(tz){
      const fmt = new Intl.DateTimeFormat("en-US", {
        timeZone: tz, year:"numeric", month:"2-digit", day:"2-digit",
        hour:"2-digit", minute:"2-digit", second:"2-digit", hour12:false
      });
      const p = Object.fromEntries(fmt.formatToParts(new Date()).map(x=>[x.type,x.value]));
      return new Date(`${p.year}-${p.month}-${p.day}T${p.hour}:${p.minute}:${p.second}`);
    }
    function minutesSinceMidnight(d){ return d.getHours()*60 + d.getMinutes(); }

    function convertFromCA(hhmm){
      const mins = toMinutes(hhmm) + DISPLAY_OPTS[displayKey].offsetMinutesFromCA;
      const norm = ((mins % 1440) + 1440) % 1440;
      const h = Math.floor(norm/60), m = norm % 60;
      return fmt12(h,m);
    }
    function fmtRangeDisplay(startHHMM,endHHMM){ return `${convertFromCA(startHHMM)} â€“ ${convertFromCA(endHHMM)}`; }

    const WEEK = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
    function displayDayName(dayIdxCA, minsCA){
      const off = DISPLAY_OPTS[displayKey].offsetMinutesFromCA;
      const total = minsCA + off;
      let shift = 0;
      if (total < 0) shift = -1;
      else if (total >= 1440) shift = 1;
      const idx = (dayIdxCA + shift + 7) % 7;
      return WEEK[idx];
    }

    function currentBlockForCA(dayIndex, minutes){
      const blocks = schedule[dayIndex] || [];
      for (const b of blocks){
        const s = toMinutes(b.start), e = toMinutes(b.end);
        if (minutes >= s && minutes < e) return b;
      }
      return null;
    }

    // ---------- DOM ----------
    const dayLabelEl   = document.getElementById("dayLabel");
    const statusEl     = document.getElementById("status");
    const rangeEl      = document.getElementById("range");
    const clockEl      = document.getElementById("clock");
    const tzToggle     = document.getElementById("tzToggle");
    const tzMenu       = document.getElementById("tzMenu");
    const previewToggle= document.getElementById("previewToggle");
    const previewPanel = document.


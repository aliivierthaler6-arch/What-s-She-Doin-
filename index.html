<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Where the fuck is my girlfriend?</title>

  <!-- Fonts: Pinyon Script (title), Inika (everything else) -->
  <link href="https://fonts.googleapis.com/css2?family=Inika:wght@400;700&family=Pinyon+Script&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg1:#eddcff;
      --bg2:#dcc6ff;
      --card-bg: rgba(255,255,255,0.16);
      --ink:#1b1330;
      --ring: rgba(255,255,255,0.45);
      --accent:#b388ff;
      --shadow: 0 12px 30px rgba(20,10,40,.18);
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body{
      margin:0;
      /* Heart wallpaper + gradient */
      background:
        url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='36' height='36' viewBox='0 0 24 24'><path d='M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 6 4.02 4 6.5 4c1.73 0 3.39 1 4.2 2.43C11.51 5 13.17 4 14.9 4 17.38 4 19.4 6 19.4 8.5c0 3.78-3.41 6.86-8.55 11.53L12 21.35z' fill='%23100a22' fill-opacity='0.26'/></svg>") repeat,
        linear-gradient(160deg,var(--bg1),var(--bg2));
      background-size: 36px 36px, auto;
      color:var(--ink);
      font-family: 'Inika', serif;
      display:grid;
      place-items:center;
      padding:24px;
    }

    /* L-hold: pulse the BACKGROUND hearts 3x, 1s each */
    body.hearts-pulse { animation: heartsPulse 1s ease-in-out 3; }
    @keyframes heartsPulse {
      0%,100% { background-size: 36px 36px, auto; }
      50%     { background-size: 44px 44px, auto; }
    }

    .wrap{ width:min(840px,95vw); text-align:center; position:relative; z-index:1; }

    .card{
      background:var(--card-bg);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border:2px solid var(--ring);
      border-radius:22px;
      padding:22px clamp(14px,4vw,28px);
      box-shadow: var(--shadow);
      color:var(--ink);
      text-align:center;
      position:relative;
    }
    .header-card { margin-bottom: 16px; }

    .title{
      margin:0;
      font-family:'Pinyon Script', cursive;
      font-size: clamp(28px, 6vw, 54px);
      font-weight: 400;
      color:#000;
      line-height:1.05;
    }
    #dayLabel{
      margin:8px 0 0 0;
      font-size: clamp(16px, 3.6vw, 28px);
      font-weight: 700;
      letter-spacing:.2px;
      color:#000;
      font-family: 'Inika', serif;
    }

    .big{
      font-size: clamp(22px, 4.6vw, 34px);
      font-weight: 700;
      line-height: 1.25;
      cursor: default;
    }
    .big.clickable { cursor: pointer; text-decoration: underline; text-underline-offset: 3px; }

    .range, .clock{
      font-size: clamp(14px, 2.6vw, 18px);
      opacity: 0.95;
      margin-top:10px;
      font-weight: 400;
    }

    /* TZ toggle */
    .tz-toggle{
      position:absolute; top:10px; right:10px;
      background: var(--accent);
      color:#fff; border:none; cursor:pointer;
      font-weight:700; border-radius:999px;
      padding:6px 12px; box-shadow:0 8px 18px rgba(0,0,0,.15);
      letter-spacing:.2px;
      font-family: 'Inika', serif;
    }
    .tz-menu{
      position:absolute; top:48px; right:10px;
      background:#fff; color:#1f1236;
      border-radius:12px; border:2px solid var(--ring);
      box-shadow: var(--shadow);
      display:none; min-width: 190px; overflow:hidden;
      text-align:left;
      font-family: 'Inika', serif;
      z-index: 20;
    }
    .tz-item{ padding:10px 12px; cursor:pointer; font-weight:700; border-bottom:1px solid #00000010; }
    .tz-item:last-child{ border-bottom:none; }
    .tz-item:hover{ background:#f3ecff; }

    /* FX overlay for Konami storm */
    .fx-layer{
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 999;
      overflow: hidden;
    }

    .kiss{
      position: absolute;
      top: -10vh;
      will-change: transform, opacity;
      animation-name: fall;
      animation-timing-function: linear;
      animation-fill-mode: forwards;
      filter: drop-shadow(0 6px 10px rgba(0,0,0,.15));
    }
    @keyframes fall{
      0%   { transform: translateY(-10vh) translateX(0) rotate(0deg); opacity: 1; }
      100% { transform: translateY(120vh) translateX(var(--drift, 0px)) rotate(var(--rot, 0deg)); opacity: 0.9; }
    }

    @media (prefers-reduced-motion:no-preference){
      .fade{ animation:fade .4s ease-out }
      @keyframes fade{ from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:none} }
    }
    @media (prefers-reduced-motion: reduce){
      body.hearts-pulse { animation: none; }
    }
  </style>
</head>
<body>
  <div class="wrap" id="widgetRoot" tabindex="0" aria-label="Class widget">
    <!-- Header card: Title + Day -->
    <div class="card header-card fade">
      <h1 class="title">Where the fuck is my girlfriend?</h1>
      <h2 id="dayLabel">Loading…</h2>
    </div>

    <!-- Main class/status card -->
    <div class="card fade">
      <!-- TZ toggle -->
      <button id="tzToggle" class="tz-toggle" aria-haspopup="true" aria-expanded="false">🌴 California</button>
      <div id="tzMenu" class="tz-menu" role="menu" aria-label="Display timezone">
        <div class="tz-item" data-tz="CA" role="menuitem">🌴 California</div>
        <div class="tz-item" data-tz="CHI" role="menuitem">🫘 Chicago</div>
      </div>

      <div id="status" class="big">Loading…</div>
      <div id="range" class="range">—</div>
      <div id="clock" class="clock">—</div>
    </div>
  </div>

  <script>
    /* ===== Schedule (anchored to California) ===== */
    const schedule = {
      1: [
        { name: "Chemistry",           start: "10:00", end: "10:50" },
        { name: "Intro to Psychology", start: "11:00", end: "12:15" },
        { name: "Uncanny",             start: "13:15", end: "14:30" },
      ],
      2: [ { name: "Reasoning bout Unreasonable", start: "11:00", end: "12:15" } ],
      3: [
        { name: "Chemistry",           start: "10:00", end: "10:50" },
        { name: "Intro to Psychology", start: "11:00", end: "12:15" },
        { name: "Uncanny",             start: "13:15", end: "14:30" },
      ],
      4: [
        { name: "Reasoning bout Unreasonable", start: "11:00", end: "12:15" },
        { name: "Chem Lab",                     start: "13:00", end: "16:00" },
      ],
      5: [ { name: "Chemistry", start: "10:00", end: "10:50" } ],
      0: [], 6: []
    };

    const lockedBase = "She's locked asf";
    const BASE_TZ = "America/Los_Angeles";

    // Display timezones (labels + offsets from California wall time)
    const DISPLAY_OPTS = {
      CA: { label: "🌴 California", tz: "America/Los_Angeles", offsetMinutesFromCA: 0 },
      CHI:{ label: "🫘 Chicago",    tz: "America/Chicago",     offsetMinutesFromCA: 120 }, // PT -> CT = +2h
    };
    let displayKey = localStorage.getItem("displayTZ") || "CA";

    // ---------- Helpers ----------
    function toMinutes(hhmm){ const [h,m]=hhmm.split(":").map(Number); return h*60+m; }
    function pad(n){ return n.toString().padStart(2,"0"); }
    function fmt12(h24,m){ const am=h24<12; const h12=((h24+11)%12)+1; return `${h12}:${pad(m)} ${am?"AM":"PM"}`; }

    function nowInTZ(tz){
      const fmt = new Intl.DateTimeFormat("en-US", {
        timeZone: tz, year:"numeric", month:"2-digit", day:"2-digit",
        hour:"2-digit", minute:"2-digit", second:"2-digit", hour12:false
      });
      const p = Object.fromEntries(fmt.formatToParts(new Date()).map(x=>[x.type,x.value]));
      return new Date(`${p.year}-${p.month}-${p.day}T${p.hour}:${p.minute}:${p.second}`);
    }
    function minutesSinceMidnight(d){ return d.getHours()*60 + d.getMinutes(); }

    // Convert a California wall-time "HH:MM" to selected display zone via fixed offset
    function convertFromCA(hhmm){
      const mins = toMinutes(hhmm) + DISPLAY_OPTS[displayKey].offsetMinutesFromCA;
      const norm = ((mins % 1440) + 1440) % 1440;
      const h = Math.floor(norm/60), m = norm % 60;
      return fmt12(h,m);
    }
    function fmtRangeDisplay(startHHMM,endHHMM){ return `${convertFromCA(startHHMM)} – ${convertFromCA(endHHMM)}`; }

    // Emojis for classes
    function decorate(name){
      if (/^Chemistry$/i.test(name)) return "🧬 Chemistry";
      if (/^Chem Lab$/i.test(name)) return "🧪 Chem Lab";
      if (/^Intro to Psychology$/i.test(name)) return "🧠 Intro to Psychology";
      if (/^Uncanny$/i.test(name)) return "👁️‍🗨️ Uncanny";
      if (/^Reasoning/i.test(name)) return "🐔 Reasoning ’bout Unreasonable";
      return name;
    }

    function currentBlockForCA(dayIndex, minutes){
      const blocks = schedule[dayIndex] || [];
      for (const b of blocks){
        const s = toMinutes(b.start), e = toMinutes(b.end);
        if (minutes >= s && minutes < e) return b;
      }
      return null;
    }

    // ---------- DOM ----------
    const root      = document.getElementById("widgetRoot");
    const dayLabelEl= document.getElementById("dayLabel");
    const statusEl  = document.getElementById("status");
    const rangeEl   = document.getElementById("range");
    const clockEl   = document.getElementById("clock");
    const tzToggle  = document.getElementById("tzToggle");
    const tzMenu    = document.getElementById("tzMenu");

    function updateToggleUI(){
      tzToggle.textContent = DISPLAY_OPTS[displayKey].label;
      tzToggle.setAttribute("aria-expanded", tzMenu.style.display === "block");
    }
    function openMenu(show){
      tzMenu.style.display = show ? "block" : "none";
      updateToggleUI();
    }
    tzToggle.addEventListener("click", () => openMenu(tzMenu.style.display !== "block"));
    tzMenu.addEventListener("click", (e) => {
      const item = e.target.closest(".tz-item");
      if(!item) return;
      displayKey = item.dataset.tz;
      localStorage.setItem("displayTZ", displayKey);
      openMenu(false);
      update();
    });
    document.addEventListener("click", (e) => {
      if (!tzMenu.contains(e.target) && e.target !== tzToggle) openMenu(false);
    });

    // ---------- Locked quip rotation ----------
    const LOCKED_QUIPS = [
      "IDK but did you know Tame Impala is only one guy?!",
      "Probably not her homework.",
      "She’s hydrating aggressively",
      "She’s calibrating the vibesometer.",
      "Learning things to tell you first.",
      "She’s thinking about you I can’t lie",
      "Bro… She’s still just missing you",
      "You wouldn’t believe me if I told you.",
      "Straight Jorkin it",
      "She’s watching you through your computer (lovingly)",
      "Can’t tell you that. It’s top-secret.",
      "Counting down the minutes until she can see you again.",
      "Imagining what she would look like if she was a worm",
      "Mentally in Chicago, physically in Pitzer",
      "Plot twist: she’s actually studying",
      "nvm she’s on her phone watching reels",
      "Snacking on some feminist literature (She’s 6’2 btw);)",
      "She’s Pondering",
      "She’s hitting her vape in the bathroom",
      "Explaining the entire timeline of how they caught Osama Bin Laden."
    ];
    let lockedIndex = -1; // -1 = base phrase; otherwise index in LOCKED_QUIPS
    let isLockedNow = false;

    statusEl.addEventListener("click", () => {
      if (!isLockedNow) return; // only rotate when locked
      lockedIndex++;
      if (lockedIndex >= LOCKED_QUIPS.length) lockedIndex = -1; // loop back to base phrase
      renderLockedLine();
    });

    function renderLockedLine(){
      statusEl.classList.add("clickable");
      if (lockedIndex === -1) {
        statusEl.textContent = "She's locked asf";
      } else {
        statusEl.textContent = LOCKED_QUIPS[lockedIndex];
      }
    }

    // ---------- Main update ----------
    function update(){
      // Logic time: California
      const nowCA = nowInTZ(BASE_TZ);
      const dayIndexCA = nowCA.getDay();
      const minsCA = minutesSinceMidnight(nowCA);

      // Day label + live clock in selected display zone
      const dispTZ = DISPLAY_OPTS[displayKey].tz;
      dayLabelEl.textContent = new Intl.DateTimeFormat("en-US", { weekday:"long", timeZone: dispTZ }).format(new Date());
      clockEl.textContent = new Intl.DateTimeFormat("en-US", {
        timeZone: dispTZ, hour:"2-digit", minute:"2-digit", second:"2-digit", hour12:true
      }).format(new Date());

      // Determine class state (logic in CA)
      const blocks = schedule[dayIndexCA] || [];
      const block  = currentBlockForCA(dayIndexCA, minsCA);

      if (block){
        isLockedNow = false;
        statusEl.classList.remove("clickable");
        statusEl.textContent = decorate(block.name);
        rangeEl.textContent  = `${fmtRangeDisplay(block.start, block.end)} (${DISPLAY_OPTS[displayKey].label})`;
      } else {
        isLockedNow = true;
        renderLockedLine();

        // Next class later today?
        const next = blocks.find(b => minsCA < toMinutes(b.start));
        if (next){
          rangeEl.textContent  = `Next Class: ${decorate(next.name)} • ${fmtRangeDisplay(next.start, next.end)} (${DISPLAY_OPTS[displayKey].label})`;
        } else {
          rangeEl.textContent  = ""; // after last class or weekend: just locked
        }
      }
    }

    updateToggleUI();
    update();
    setInterval(update, 1000);

    // ================================
    // Konami & L-hold (widget-scoped), with capture to beat global easter eggs
    // ================================
    let isHovering = false;
    let tapActive = false;
    let tapTimer = null;
    root.addEventListener("mouseenter", ()=>{ isHovering = true; });
    root.addEventListener("mouseleave", ()=>{ isHovering = false; });
    root.addEventListener("pointerdown", ()=>{
      tapActive = true;
      clearTimeout(tapTimer);
      tapTimer = setTimeout(()=>{ tapActive = false; }, 8000); // 8s grace after tap/focus
    });
    root.addEventListener("focusin", ()=>{
      tapActive = true;
      clearTimeout(tapTimer);
      tapTimer = setTimeout(()=>{ tapActive = false; }, 8000);
    });
    function widgetActive(){ return isHovering || tapActive; }

    // Konami sequence
    const KONAMI = ["ArrowUp","ArrowUp","ArrowDown","ArrowDown","ArrowLeft","ArrowRight","ArrowLeft","ArrowRight","b","a"];
    const KONAMI_KEYS = new Set(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","b","a"]);
    let buffer = [];

    // CAPTURING listener: tries to swallow Konami keys while widget is active
    window.addEventListener("keydown", (e) => {
      const key = e.key.length === 1 ? e.key.toLowerCase() : e.key;
      const normalized = (e.key.length === 1 ? e.key.toLowerCase() : e.key);

      if (widgetActive() && KONAMI_KEYS.has(normalized)) {
        // stop other scripts (and many extensions) from seeing these keys
        e.stopImmediatePropagation?.();
        e.stopPropagation();
        e.preventDefault();
      }

      if (!widgetActive()) return;

      // L-hold start
      if (key === "l") handleLHoldStart();

      // track sequence
      buffer.push(normalized);
      if (buffer.length > KONAMI.length) buffer.shift();

      const match = KONAMI.every((v, i) => {
        const expect = v.length === 1 ? v.toLowerCase() : v;
        return buffer[i] === expect;
      });
      if (match) {
        triggerKissStorm();
        buffer = []; // reset
      }
    }, true); // <-- capture

    window.addEventListener("keyup", (e)=>{
      if (e.key.toLowerCase() === "l") handleLHoldEnd();
    }, true); // capture to swallow if needed

    // ----- L hold for 3s -> pulse BACKGROUND hearts 3x (1s each)
    let lHoldTimer = null;
    let lHolding = false;
    function handleLHoldStart(){
      if (lHolding) return;
      lHolding = true;
      clearTimeout(lHoldTimer);
      lHoldTimer = setTimeout(()=>{
        if (widgetActive()){
          document.body.classList.add("hearts-pulse");
          setTimeout(()=>document.body.classList.remove("hearts-pulse"), 3200);
        }
        lHolding = false;
      }, 3000); // hold L for 3 seconds
    }
    function handleLHoldEnd(){
      clearTimeout(lHoldTimer);
      lHolding = false;
    }

    // ----- Continuous kiss/heart storm for 5s
    function triggerKissStorm(){
      const layer = document.createElement("div");
      layer.className = "fx-layer";
      layer.setAttribute("aria-hidden", "true");
      document.body.appendChild(layer);

      const EMOJIS = ["❤️","💋"];
      const start = Date.now();
      const duration = 5000;
      const vw = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);

      const tick = () => {
        const burstCount = 12 + Math.floor(Math.random()*10); // 12–21 per burst
        for (let i=0;i<burstCount;i++){
          const span = document.createElement("span");
          span.className = "kiss";
          span.textContent = EMOJIS[Math.random()<0.65 ? 0 : 1];

          const left = Math.random()*vw;
          const size = 16 + Math.random()*28; // 16–44px
          const delay = Math.random()*0.25;
          const drift = (Math.random()*200 - 100) + "px";
          const rot   = (Math.random()*360 - 180) + "deg";
          const fallDur = (3.8 + Math.random()*1.8).toFixed(2) + "s"; // 3.8–5.6s

          span.style.left = left + "px";
          span.style.fontSize = size + "px";
          span.style.animationDelay = delay + "s";
          span.style.animationDuration = fallDur;
          span.style.setProperty("--drift", drift);
          span.style.setProperty("--rot", rot);

          layer.appendChild(span);
        }

        if (Date.now() - start < duration){
          stormTimer = setTimeout(tick, 140 + Math.random()*120); // ~8–10 bursts/sec
        }
      };

      let stormTimer = setTimeout(tick, 0);

      setTimeout(()=>{
        clearTimeout(stormTimer);
        setTimeout(()=>layer.remove(), 1800);
      }, duration);
    }
  </script>
</body>
</html>



